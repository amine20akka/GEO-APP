<!-- Filter panel -->
<div class="filter-panel">
    <form [formGroup]="filterForm" (ngSubmit)="onSubmit()">
        <div class="dialog-title">
            <mat-icon>filter_list</mat-icon>
            <h1 mat-dialog-title><strong>Filtrer les couches</strong></h1>
        </div>
        <div mat-dialog-content>
            <div class="form-container">
                <mat-form-field appearance="fill" class="form-fields">
                    <mat-label>Couche</mat-label>
                    <mat-select formControlName="selectedLayer" (selectionChange)="onLayerChange($event.value)">
                        @for (layer of allLayers; track trackByFn($index, layer);) {
                        <mat-option [value]="layer">{{ layer.name }}</mat-option>
                        }
                    </mat-select>
                </mat-form-field>

                @if (columns.length > 0) {
                <mat-form-field appearance="fill" class="form-fields">
                    <mat-label>Attribut</mat-label>
                    <mat-select formControlName="selectedColumn" (selectionChange)="onColumnChange($event.value)">
                        @for (column of columns; track trackByFn($index, column);) {
                        <mat-option [value]="column">{{ column }}</mat-option>
                        }
                    </mat-select>
                </mat-form-field>
                }

                @if (columnType === 'string') {
                <div>
                    <mat-form-field appearance="fill" class="form-fields">
                        <mat-label>Texte de filtre</mat-label>
                        <input matInput formControlName="filterText" />
                    </mat-form-field>
                </div>
                }

                @if (columnType === 'number'){
                <div>
                    <mat-form-field appearance="fill" class="form-fields">
                        <mat-label>Minimum</mat-label>
                        <input matInput type="number" formControlName="filterMinNumber" />
                    </mat-form-field>
                    <mat-form-field appearance="fill" class="form-fields">
                        <mat-label>Maximum</mat-label>
                        <input matInput type="number" formControlName="filterMaxNumber" />
                    </mat-form-field>
                </div>
                }
            </div>
        </div>
        <div mat-dialog-actions>
            <button mat-button type="button" (click)="reset()" [disabled]="!selectedLayer">Réinitailser le filtre</button>
            <button mat-raised-button color="primary" type="submit" [disabled]="!filterForm.valid">Appliquer</button>
        </div>
        <button mat-button class="reset-all" type="button" (click)="resetAll()">Réinitailser tous les filtres</button>
    </form>
</div>